<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="manifest" href="manifest.json">

<script>
if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("service-worker.js");
}
</script>

<title>交通費精算</title>
<style>
  body { font-family: sans-serif; padding: 20px; }
  table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
  th, td { border: 1px solid #999; padding: 6px; text-align: center; }
  th { background: #f0f0f0; }
  input[type="number"] { width: 90%; font-size: 16px; }
  .input { background: #ffecec; }
  .auto { color: blue; font-weight: bold; }
button {
  width: 100%;
  padding: 18px;
  font-size: 22px;
  font-weight: bold;
  background-color: #4CAF50;
  color: white;
  border: none;
  border-radius: 12px;
  margin: 20px 0;
}
button:active {
  background-color: #3e8e41;
  transform: scale(0.98);
}

.reset-btn {
  width: 100%;
  padding: 16px;
  font-size: 20px;
  background-color: #85cdf9;
  color: #333;
  border: none;
  border-radius: 12px;
  margin-bottom: 25px;
}

</style>
</head>

<body>

<h2>① 交通費精算</h2>

<!-- 基本情報 -->
<table>
<tr><th>①1Lの燃費<br> (km/L)</th><td><input class="input" id="fuel" type="number" step="0.1"></td></tr>
<tr><th>②ガソリン代<br>単価 (円/L)</th><td><input class="input" id="gas" type="number"></td></tr>
</table>

<!-- ルート -->
<table>
<tr><th>③走行距離 (km)</th><th>④有料道路（高速料金）<br>駐車場代、他 (円)</th></tr>
<tr><td><input class="dist input" type="number" step="0.1"></td><td><input class="toll input" type="number"></td></tr>
<tr><td><input class="dist input" type="number" step="0.1"></td><td><input class="toll input" type="number"></td></tr>
<tr><td><input class="dist input" type="number" step="0.1"></td><td><input class="toll input" type="number"></td></tr>
<tr><td><input class="dist input" type="number" step="0.1"></td><td><input class="toll input" type="number"></td></tr>
<tr><td><input class="dist input" type="number" step="0.1"></td><td><input class="toll input" type="number"></td></tr>
<tr><td><input class="dist input" type="number" step="0.1"></td><td><input class="toll input" type="number"></td></tr>
</table>

<!-- 計算結果 -->
<table>
<tr><th>⑤総走行距離<font size="2">（③の合計）</font></th><td class="auto" id="totalKm">-</td></tr>
<tr><th>⑥使用燃料 (L)<br><font size="2">⑤総走行距離 ÷ ①1Lの燃費<br>※小数点2切り上げ</font></th><td class="auto" id="usedFuel">-</td></tr>
<tr><th>⑦ガソリン代<br><font size="2">⑥使用燃料 × ②ｶﾞｿﾘﾝ1Lの単価<br>※小数点1切り上げ</font></th><td class="auto" id="gasTotal">-</td></tr>
<tr><th>⑧有料道路＆高速代<br>駐車場、他<font size="2">（④の合計）</font></th><td class="auto" id="tollTotal">-</td></tr>
<tr><th>総合計（⑦+⑧）</th><td class="auto" id="grandTotal">-</td></tr>
</table>

<!-- 人数割 -->
<table>
<tr>
  <th>役割</th>
  <th>人数</th>
  <th>1人あたり</th>
</tr>
<tr>
  <td>運転手</td>
  <td><input id="driverCount" class="input" type="number" value="1"></td>
  <td class="auto" id="driverPay">-</td>
</tr>
<tr>
  <td>同乗者</td>
  <td><input id="passCount" class="input" type="number" value="3"></td>
  <td class="auto" id="passPay">-</td>
</tr>
</table>

<button onclick="calc()">計算</button>
<button class="reset-btn" onclick="resetTraffic()">リセット</button>

<script>
function ceil(num, digit) {
  const pow = Math.pow(10, digit);
  return Math.ceil(num * pow) / pow;
}

function calc() {
  const fuel = Number(document.getElementById("fuel").value);
  const gas = Number(document.getElementById("gas").value);

  let totalKm = 0;
  document.querySelectorAll(".dist").forEach(d => totalKm += Number(d.value || 0));

  let tollTotal = 0;
  document.querySelectorAll(".toll").forEach(t => tollTotal += Number(t.value || 0));

  // ⑤ 走行距離 ÷ 燃費（小数点1切り上げ）
  const usedFuel = ceil(totalKm / fuel, 1);

  // ⑥ 燃料 × ガソリン代（小数点1切り上げ）
  const gasTotal = ceil(usedFuel * gas, 1);

  const grand = gasTotal + tollTotal;

  document.getElementById("totalKm").textContent = totalKm.toFixed(1) + " km";
  document.getElementById("usedFuel").textContent = usedFuel + " L";
  document.getElementById("gasTotal").textContent = gasTotal.toLocaleString() + " 円";
  document.getElementById("tollTotal").textContent = tollTotal.toLocaleString() + " 円";
  document.getElementById("grandTotal").textContent = grand.toLocaleString() + " 円";

 // ⑦ 人数割（運転手が端数を負担）
const drivers = Number(document.getElementById("driverCount").value);
const passengers = Number(document.getElementById("passCount").value);
const people = drivers + passengers;

const roundUnit = 10; // ← 100円単位（10なら10円）

// 同乗者1人あたり（きりのいい数字）
const passengerPay =
  Math.ceil(grand / people / roundUnit) * roundUnit;

// 同乗者合計
const passengerTotal = passengerPay * passengers;

// 運転手は端数をすべて持つ
const driverPay = grand - passengerTotal;

document.getElementById("driverPay").textContent =
  driverPay.toLocaleString() + " 円";
document.getElementById("passPay").textContent =
  passengerPay.toLocaleString() + " 円";
}

function resetTraffic() {
  // 入力欄クリア
  document.querySelectorAll(
    '#fuel, #gas, .dist, .toll, #driverCount, #passCount'
  ).forEach(el => el.value = '');

  // 初期値に戻す
  document.getElementById("driverCount").value = 1;
  document.getElementById("passCount").value = 3;

  // 表示リセット
  ["totalKm", "usedFuel", "gasTotal", "tollTotal", "grandTotal",
   "driverPay", "passPay"]
  .forEach(id => document.getElementById(id).textContent = '-');
}
    
</script>

<h2>② 食費の割り勘</h2>

<!-- 割り勘対象 -->
<table>
<tr>
  <th>割勘対象メニュー</th>
  <th>金額を入力</th>
</tr>
<tr><td>メニュー１</td><td><input class="food input" type="number"></td></tr>
<tr><td>メニュー２</td><td><input class="food input" type="number"></td></tr>
<tr><td>メニュー３</td><td><input class="food input" type="number"></td></tr>
<tr><td>メニュー４</td><td><input class="food input" type="number"></td></tr>
<tr>
  <th>人数</th>
  <td><input id="foodPeople" class="input" type="number" value="4"></td>
</tr>
</table>

<table>
<tr>
  <th>一人あたりの割勘額</th>
  <td class="auto" id="foodPer">-</td>
</tr>
</table>

<!-- 個別注文 -->
<table>
<tr>
  <th>名前</th>
  <th>個々の注文額</th>
  <th>割勘額</th>
  <th>支払合計</th>
</tr>

<tr>
  <td>対象者Ａ</td>
  <td><input class="personal input" type="number"></td>
  <td class="auto perCell"></td>
  <td class="auto totalCell"></td>
</tr>
<tr>
  <td>対象者Ｂ</td>
  <td><input class="personal input" type="number"></td>
  <td class="auto perCell"></td>
  <td class="auto totalCell"></td>
</tr>
<tr>
  <td>対象者Ｃ</td>
  <td><input class="personal input" type="number"></td>
  <td class="auto perCell"></td>
  <td class="auto totalCell"></td>
</tr>
<tr>
  <td>対象者Ｄ</td>
  <td><input class="personal input" type="number"></td>
  <td class="auto perCell"></td>
  <td class="auto totalCell"></td>
</tr>
</table>
    
<button onclick="calcFood()">計算</button>
<button class="reset-btn" onclick="resetFood()">リセット</button>

<script>
function calcFood() {
  // 割り勘対象合計
  let sum = 0;
  document.querySelectorAll(".food").forEach(f => {
    sum += Number(f.value || 0);
  });

  const people = Number(document.getElementById("foodPeople").value);
  if (people <= 0) return;

  // 一人当たり
  const per = Math.ceil(sum / people);
  document.getElementById("foodPer").textContent =
    per.toLocaleString() + " 円";

  // 各人の計算
  document.querySelectorAll(".personal").forEach((p, i) => {
    const personal = Number(p.value || 0);
    const total = personal + per;

    document.querySelectorAll(".perCell")[i].textContent =
      per.toLocaleString() + " 円";

    document.querySelectorAll(".totalCell")[i].textContent =
      total.toLocaleString() + " 円";
  });
}

function resetFood() {
  // 割り勘対象・個別注文をクリア
  document.querySelectorAll('.food, .personal')
    .forEach(el => el.value = '');

  // 人数を初期値へ
  document.getElementById("foodPeople").value = 4;

  // 表示クリア
  document.getElementById("foodPer").textContent = '-';
  document.querySelectorAll('.perCell, .totalCell')
    .forEach(el => el.textContent = '');
}


</script>

</body>
</html>
